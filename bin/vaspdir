#! /usr/bin/env ruby
# coding: utf-8

# Manipulate VaspDir from command line.

require "comana"
require "fileutils"
require "optparse"
require "pp"
require "rubygems"
require "vasputils"

def show_usage
    puts <<-HERE
USAGE
    vaspdir command [option] [path]

E.G.,
    vaspdir show [option] [path]
    vaspdir run [path]
    vaspdir clean [path]
        delete output files of vasp command.
    vaspdir initialize [path]
        delete all files except for four input files.
        (INCAR, KPOINTS, POSCAR, POTCAR.)

    If [path] is not explicitely indicated, "." would be used.

    Lines from stdin are simply added to end of command line arguments.
    HERE
end

stdin_items = $stdin.readlines.map{|str| str.chomp}

command = ARGV.shift

args = ARGV + stdin_items

case command
when "show"
    VaspUtils::VaspDir.show_inspect(args)
when "run"
    VaspUtils::VaspDir.run(args)
when "clean"
    VaspUtils::VaspDir.reset_clean(args)
when "initialize"
    VaspUtils::VaspDir.reset_initialize(args)
#when "poscar"
#    #VaspUtils::VaspDir.show_inspect(args)
#    #pp VaspUtils::VaspDir.poscar(args)
when "--help"
    show_usage
else
    puts "Unknown command: #{command}"
    show_usage
end

exit
